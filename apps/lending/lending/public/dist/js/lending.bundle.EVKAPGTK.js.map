{
  "version": 3,
  "sources": ["../../../../../apps/lending/lending/public/js/loan_common.js"],
  "sourcesContent": ["// Copyright (c) 2016, Frappe Technologies Pvt. Ltd. and contributors\n// For license information, please see license.txt\nfrappe.provide(\"lending.common\");\n\nlending.common = {\n\tsetup_filters: function(doctype) {\n\t\tfrappe.ui.form.on(doctype, {\n\t\t\trefresh: function(frm) {\n\t\t\t\tif (['Loan Disbursement', 'Loan Repayment', 'Loan Interest Accrual', 'Loan Write Off'].includes(frm.doc.doctype)\n\t\t\t\t\t&& frm.doc.docstatus > 0) {\n\t\t\t\t\tcur_frm.add_custom_button(__('Accounting Ledger'), function() {\n\t\t\t\t\t\tfrappe.route_options = {\n\t\t\t\t\t\t\tvoucher_no: frm.doc.name,\n\t\t\t\t\t\t\tfrom_date: frm.doc.posting_date,\n\t\t\t\t\t\t\tto_date: frm.doc.posting_date,\n\t\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\t\tgroup_by: \"Group by Voucher (Consolidated)\",\n\t\t\t\t\t\t\tshow_cancelled_entries: frm.doc.docstatus === 2\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfrappe.set_route(\"query-report\", \"General Ledger\");\n\t\t\t\t\t}, __(\"View\"));\n\t\t\t\t}\n\t\t\t\terpnext.hide_company();\n\t\t\t\tfrm.trigger(\"set_company_filter\");\n\t\t\t},\n\t\t\tapplicant_type: function(frm) {\n\t\t\t\tfrm.trigger(\"set_company_filter\");\n\t\t\t},\n\t\t\tset_company_filter: function(frm) {\n\t\t\t\tif ([\"Loan Application\", \"Loan\"].includes(frm.doc.doctype)) {\n\t\t\t\t\tif (frm.doc.applicant_type === \"Employee\") {\n\t\t\t\t\t\tfrm.set_query(\"applicant\", function() {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\"filters\": {\n\t\t\t\t\t\t\t\t\t\"company\": frm.doc.company\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrm.set_query(\"applicant\", function() {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\"filters\": {\n\t\t\t\t\t\t\t\t\t\"docstatus\": 0\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tapplicant: function(frm) {\n\t\t\t\tif (![\"Loan Application\", \"Loan\"].includes(frm.doc.doctype)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (frm.doc.applicant) {\n\t\t\t\t\tfrappe.model.with_doc(frm.doc.applicant_type, frm.doc.applicant, function() {\n\t\t\t\t\t\tvar applicant = frappe.model.get_doc(frm.doc.applicant_type, frm.doc.applicant);\n\t\t\t\t\t\tfrm.set_value(\"applicant_name\",\n\t\t\t\t\t\t\tapplicant.employee_name || applicant.member_name);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfrm.set_value(\"applicant_name\", null);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}"],
  "mappings": "MAEA,OAAO,QAAQ,gBAAgB,EAE/B,QAAQ,OAAS,CAChB,cAAe,SAASA,EAAS,CAChC,OAAO,GAAG,KAAK,GAAGA,EAAS,CAC1B,QAAS,SAASC,EAAK,CAClB,CAAC,oBAAqB,iBAAkB,wBAAyB,gBAAgB,EAAE,SAASA,EAAI,IAAI,OAAO,GAC3GA,EAAI,IAAI,UAAY,GACvB,QAAQ,kBAAkB,GAAG,mBAAmB,EAAG,UAAW,CAC7D,OAAO,cAAgB,CACtB,WAAYA,EAAI,IAAI,KACpB,UAAWA,EAAI,IAAI,aACnB,QAASA,EAAI,IAAI,aACjB,QAASA,EAAI,IAAI,QACjB,SAAU,kCACV,uBAAwBA,EAAI,IAAI,YAAc,CAC/C,EACA,OAAO,UAAU,eAAgB,gBAAgB,CAClD,EAAG,GAAG,MAAM,CAAC,EAEd,QAAQ,aAAa,EACrBA,EAAI,QAAQ,oBAAoB,CACjC,EACA,eAAgB,SAASA,EAAK,CAC7BA,EAAI,QAAQ,oBAAoB,CACjC,EACA,mBAAoB,SAASA,EAAK,CAC7B,CAAC,mBAAoB,MAAM,EAAE,SAASA,EAAI,IAAI,OAAO,IACpDA,EAAI,IAAI,iBAAmB,WAC9BA,EAAI,UAAU,YAAa,UAAW,CACrC,MAAO,CACN,QAAW,CACV,QAAWA,EAAI,IAAI,OACpB,CACD,CACD,CAAC,EAEDA,EAAI,UAAU,YAAa,UAAW,CACrC,MAAO,CACN,QAAW,CACV,UAAa,CACd,CACD,CACD,CAAC,EAGJ,EAEA,UAAW,SAASA,EAAK,CACpB,CAAC,CAAC,mBAAoB,MAAM,EAAE,SAASA,EAAI,IAAI,OAAO,IAItDA,EAAI,IAAI,UACX,OAAO,MAAM,SAASA,EAAI,IAAI,eAAgBA,EAAI,IAAI,UAAW,UAAW,CAC3E,IAAIC,EAAY,OAAO,MAAM,QAAQD,EAAI,IAAI,eAAgBA,EAAI,IAAI,SAAS,EAC9EA,EAAI,UAAU,iBACbC,EAAU,eAAiBA,EAAU,WAAW,CAClD,CAAC,EAGDD,EAAI,UAAU,iBAAkB,IAAI,EAEtC,CACD,CAAC,CACF,CACD",
  "names": ["doctype", "frm", "applicant"]
}
